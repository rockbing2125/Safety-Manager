# Excel 参数模板格式说明

## 模板列顺序

从 v1.1.9 开始，Excel 参数模板新增了"协议位"列，完整列顺序如下：

| 列序号 | 列名 | 说明 | 示例 |
|--------|------|------|------|
| 1 | 类别 | 参数分类 | 电压等级要求 |
| 2 | 参数 | 参数名称 | 额定电压 |
| 3 | 默认值 | 参数默认值 | 220V |
| 4 | 上限 | 参数上限值 | 250V |
| 5 | 下限 | 参数下限值 | 200V |
| 6 | 单位 | 参数单位 | V |
| 7 | 系数 | 参数系数 | 1.0 |
| 8 | **协议位** | **通信协议位地址（新增）** | 0x1001 |
| 9 | 备注 | 备注说明或图片 | 可选 |

## 版本更新历史

- **v1.1.9** (2025-12-04)：新增"协议位"列（第8列）
- **v1.1.8** (2025-12-04)：新增"系数"列（第7列）
- **v1.1.7及更早**：7列格式（类别、参数、默认值、上限、下限、单位、备注）

## 重要提示

1. **协议位列为最新添加**：位于"系数"列和"备注"列之间
2. **向后兼容**：系统支持 7列、8列、9列格式自动识别
3. **可选字段**：系数列和协议位列都可以为空，不影响其他功能
4. **图片支持**：备注列支持插入图片（使用 Excel 的 DISPIMG 函数）

## 数据库迁移

如果您已有旧数据，运行以下命令迁移数据库：

```bash
# 添加系数列（v1.1.8）
python add_coefficient_column.py

# 添加协议位列（v1.1.9）
python add_protocol_bit_column.py
```

系统会自动检测并添加缺失的字段，无需担心数据丢失。

## 示例

```
| 类别     | 参数     | 默认值 | 上限  | 下限  | 单位 | 系数 | 协议位 | 备注         |
|---------|---------|-------|-------|-------|------|------|--------|--------------|
| 电压要求 | 额定电压 | 220V  | 250V  | 200V  | V    | 1.0  | 0x1001 | 标准工作电压  |
| 频率响应 | 工作频率 | 50Hz  | 52Hz  | 48Hz  | Hz   | 1.0  | 0x1002 | 电网标准频率  |
```

## 更新日期

2025-12-04
